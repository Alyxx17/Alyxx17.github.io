---
title: 无约束MPC基本原理
date: 2026-02-05 10:00:00 +0800
categories: [控制,MPC]
tags: [控制]
math: true  # <-- 就是这一行，启用本页的数学公式渲染
---

## 核心原理
MPC控制的基本原理可以概括为：在每个采样时刻用最新得到的测量值刷新优化问题，并求解刷新后的优化问题,将得到的优化解（可能只是次优解）的第一个分量 u*(k|k)作用于系统,如此循环往复至永远。
换句话说，预测控制算法包括三个步骤：  

（1）预测系统未来动态:  

（2）(数值) 求解优化问题;  

（3） 将优化解的第一个元素 (或者说一部分)作用于系统；  

实际上通俗来说，MPC预测控制有点类似于下棋：根据当前时刻的状态预测推演接下来的几步，但是只下一步，如此往复。  
## 增量离散状态空间模型

考虑如下连续时间域的状态空间方程：  

\begin{aligned}
\dot{x}(t) & =A_{c} x(t)+B_{c u} u(t)+B_{c d} d(t), \\
\end{aligned}  

\begin{aligned}
y_{c}(t) & =C_{c} x(t).
\end{aligned}  
其中$x(t)$是状态变量，$u(t)$是控制输入变量，$d(t)$是可以测量的外部干扰变量， $y_c$ 是被控输出变量;  

为了便于计算机控制，将上述连续时间域的状态空间方程转化为离散时间域的状态空间方程。其系数有如下关系：  

\begin{aligned}
A & =\mathrm{e}^{A_{c} T_{s}} 
\end{aligned}  

\begin{aligned}
B_{u} & =\int_{0}^{T_{s}} \mathrm{e}^{A_{c} \tau} \mathrm{~d} \tau \cdot B_{c u}
\end{aligned}  

\begin{aligned}
B_{d} & =\int_{0}^{T_{s}} \mathrm{e}^{A_{c} \tau} \mathrm{~d} \tau \cdot B_{c d}
\end{aligned}  
其中Ts为采样时间。  
因此，离散域的状态空间方程可以表示为：  

\begin{aligned}
x(k+1) &= Ax(k)+B_{u}u(k)+B_{d}d(k),
\end{aligned}  

\begin{aligned}
y_{c}(k) &= C_{c}x(k).
\end{aligned}  
为了引入积分作用以减小或消除静态误差，采用增量离散状态空间模型。  
定义:
\begin{aligned}
Δx(k) &= x(k)-x(k-1);
\end{aligned}  

\begin{aligned}
Δu(k) &= u(k)-u(k-1);
\end{aligned}  

\begin{aligned}
Δd(k) &= d(k)-d(k-1);
\end{aligned}  

由此可得增量离散状态空间模型为：  
\begin{aligned}
Δx(k+1) &= AΔx(k)+B_{u}Δu(k)+B_{d}Δd(k),
\end{aligned}  

\begin{aligned}
y_{c}(k)=C_{c}Δx(k)+y_{c}(k-1).
\end{aligned}  

本文以后的推导都基于这个增量离散状态空间模型（下称“状态空间模型”）。  
## 预测方程  
这一节将讨论MPC的第一个步骤：基于上述的状态空间模型预测系统未来的动态。  
假设所有状态变量均可测量，以最新的测量值为初始条件，设置预测时域为$p$，控制时域为$m$，且$m$≤$p$。为了便于推导，作如下假设：  
(1)控制时域之外，控制量不变，即$Δu(k+i)$=0,$i$=$m$,$m+1$,......,$p-1$;
(2)可测干扰在k时刻之后保持不变，即$d(k+i)$=0,i=1,2,......,$p$;
基于这两个假设，先预测状态变量，即：  
\begin{aligned}
Δx(k+1|k) &= AΔx(k)+B_{u}Δu(k)+B_{d}Δd(k)\\
Δx(k+2|k) &= AΔx(k+1|k)+B_{u}Δu(k+1)+B_{d}Δd(k+1)\\
&=A^2Δx(k)+AB_{u}Δu(k)++B_{u}Δu(k+1)AB_{d}Δd(k)          
\end{aligned}  

